# 도메인 이벤트

## 언제 그리고 왜 도메인 이벤트를 사용할까

- 도메인 이벤트는 도메인 모델을 완벽히 지원하며 도메인에서 일어난 어떤 사건을 나타낸다.
- 도메인 전문가의 다음과 같은 말에서 명시적인 이벤트를 모델링 해야 할 여지가 크다.
    - "... 할때"
    - "그런 일이 일어나면 ..."
    - "... 하면 저에게 알려주세요.", "... 하면 저에게 통보해 주세요."
    - "... 한 일의 발생"
- 도메인 전반에 걸쳐 일어난 사건은 바운디드 컨텍스트 전체로 전달돼야 한다.
- 이벤트가 관심이 있는 대상으로 전달됐을 땐 보통 결과적 일관성을 위해 사용된다.
- 시스템 간의 느슨한 결합을 달성.
- 시스템이 배치 처리를 수행하는 상황을 제거할 수 있다.
    - 나중에 캐치업해야 하는 일을 이벤트로 발행한다면 배치로 처리되는 사항이 하루 전체로 흩어져 짧게 처리된다.
    - 비지니스 상황은 훨신 빠른 시점에 조화를 이뤄서 사용자가 다음 단계를 수행하도록 준비를 마치게 된다.
-  모델의 기술적 구현 측면이나 헙업 시스템의 목표에 따라 도메인 전문가가 요구하는 수보다 이벤트가 더 많을 경우 이벤트 소싱을 사용한다.

## 이벤트의 모델링

- 이벤트를 모델링할 땐 해당 이벤트가 속한 바운디드 컨텍스트의 유비쿼터스 언어에 따라 이벤트와 그 속성을 명명한다.
- 애그리게잇 커맨드 실행에 따른 결과로서 이벤트가 발생한다면, 그 이름은 보통 실행된 커맨드로 부터 파생된다.
- 이벤트를 발행할 땐 이벤트의 이름에 발생의 과거 시점을 반영하는 것이 중요하다. (과거에 일어난 일이다.)
- 이벤트는 일반적으로 불변으로 설계되기 때문에 전체 상태의 초기화를 허용하는 하나의 생성자만 가지고 있으며, 각 속성의 읽기 접근자를 포함한다.
- 애플리케이션 서비스가 이벤트의 트랜잭션을 관리해야 한다.
- 구독자가 이벤트의 원인 이외의 상황까지 나타내 주길 요청한다면, 추가적인 상태와 행동의 제공이 필요할 수 있다.
    - 이벤트를 풍부하게 하는 일은 이벤트 소싱을 사용하는 상황에서 좀 더 보편적으로 이뤄진다.
    - 풍부해진 상태를 만들기 위해선 객체의 불변성을 보호하기 위해 모든 추가적인 이벤트 행동이 부작용을 일으키지 않는지 확인해야 한다.
